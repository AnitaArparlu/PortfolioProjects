---
title: 'Google Data Analytics Capstone Project: Cyclistic bike-share analysis'
author: "Arparlu @ Anita"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, message = FALSE)
```
*This is a case study as part of the google data analytics professional certificate.*

### About the company

In 2016, Cyclistic launched a successful bike-share offering. Since then, the program has grown to a fleet of 5,824 bicycles that are geotracked and locked into a network of 692 stations across Chicago. The bikes can be unlocked from one station and returned to any other station in the system anytime.

Until now, Cyclistic’s marketing strategy relied on building general awareness and appealing to broad consumer segments. One approach that helped make these things possible was the flexibility of its pricing plans: single-ride passes, full-day passes, and annual memberships. Customers who purchase single-ride or full-day passes are referred to as casual riders. Customers who purchase annual memberships are Cyclistic members.

Cyclistic’s finance analysts have concluded that annual members are much more profitable than casual riders. Although the pricing flexibility helps Cyclistic attract more customers, Moreno,the director of marketing and your manager, believes that maximizing the number of annual members will be key to future growth. Rather than creating a marketing campaign that targets all-new customers, Moreno believes there is a very good chance to convert casual riders into members. She notes that casual riders are already aware of the Cyclistic program and have chosen Cyclistic for their mobility needs.

Moreno has set a clear goal: Design marketing strategies aimed at converting casual riders into annual members. In order to do that, however, the marketing analyst team needs to better understand how annual members and casual riders differ, why casual riders would buy a membership, and how digital media could affect their marketing tactics. Moreno and her team are interested in analyzing the Cyclistic historical bike trip data to identify trends.

***

### Scenario

You are a junior data analyst working in the marketing analyst team at Cyclistic, a bike-share company in Chicago. The director of marketing believes the company’s future success depends on maximizing the number of annual memberships. Therefore, your team wants to understand how casual riders and annual members use Cyclistic bikes differently. From these insights, your team will design a new marketing strategy to convert casual riders into annual members. But first, Cyclistic executives must approve your recommendations, so they must be backed up with compelling data insights and professional data visualizations.

### Business Task

> Identify pattern and analyse how the annual members and casual riders use Cyclistics bikes differently.

***

### Summary

1. The total trip duration travelled by the casual rider is 2.03 times of the member’s.
      * 42% of rides comes from casual user.
      * 58% of rides comes from member user.
2. Casual and member user across the days of week.
      * For casual user, the total trip duration and the total number of ride is the highest on Saturday, Sunday and Friday (ranked from high to low).
      * For member user, the pattern is very consistent across the week.
3. Casual and member user across the year.
      * The number and duration of ride is closely correlated to the season of the year. Both casual and member show significant increase in ride in warmer season and sharply decrease in winter season.
4. Casual user are more likely to be couple, tourist or friends hanging out together. Part of the casual also travel back from work using bike, suggested by the peak during weekday 5pm.
5. Member are more like to be office worker who travel to and from the work with bike.
      
***

### STEP 1: Install the essential packages and set directory for files import

```{r packages, results='hide'}
library(tidyverse) #helps wrangle data
library(lubridate) #helps wrangle data attributes
library(ggplot2)  #helps visualize data
getwd() #displays your working directory
setwd("/Users/aarparlu/Documents/Case_Study/Case_Study_Cyclistic/Datasets/2020_csv") #sets your working directory to simplify calls to data
```

### STEP 2: Import Data
> Download the data from this [link](https://divvy-tripdata.s3.amazonaws.com/index.html).The data has been made available by Motivate International Inc. under this [license](https://www.divvybikes.com/data-license-agreement).

```{r message=FALSE}
# Import data of past the 12 months avaailable
jun_2020 <- read_csv("202006-divvy-tripdata.csv")
jul_2020 <- read_csv("202007-divvy-tripdata.csv")
aug_2020 <- read_csv("202008-divvy-tripdata.csv")
sep_2020 <- read_csv("202009-divvy-tripdata.csv")
oct_2020 <- read_csv("202010-divvy-tripdata.csv")
nov_2020 <- read_csv("202011-divvy-tripdata.csv")
dec_2020 <- read_csv("202012-divvy-tripdata.csv")
jan_2021 <- read_csv("202101-divvy-tripdata.csv")
feb_2021 <- read_csv("202102-divvy-tripdata.csv")
mar_2021 <- read_csv("202103-divvy-tripdata.csv")
apr_2021 <- read_csv("202104-divvy-tripdata.csv")
may_2021 <- read_csv("202105-divvy-tripdata.csv")
```

Investigate the columns

```{r, results='hide'}
# Investigate the columns to see the name of column are the same as you will have to combine into a single data frame.
colnames(jun_2020)
colnames(jul_2020)
colnames(aug_2020)
colnames(sep_2020)
colnames(oct_2020)
colnames(nov_2020)
colnames(dec_2020)
colnames(jan_2021)
colnames(feb_2021)
colnames(mar_2021)
colnames(apr_2021)
colnames(may_2021)
```

Combine all data into a single data frame

```{r, results='hide'}
# Stacking the quarter dataframe of 2020 together
all_trips <- rbind(jun_2020, jul_2020, aug_2020, sep_2020, oct_2020, nov_2020, dec_2020, jan_2021, feb_2021, mar_2021, apr_2021, may_2021)
```

### STEP 3: Data Exploration

Explore the dataset to get a idea of the what the data is about and what variable are contain in it.

```{r, results='hide'}
# Inspecting the new dataframe created
glimpse(all_trips)
summary(all_trips)
head(all_trips)

# Rename member_casual column to member_casual
all_trips <- rename(all_trips, user_type = member_casual)

# Checking the unique values of each variable 
unique(all_trips$user_type)
unique(all_trips$rideable_type)
unique(all_trips$start_station_name)
unique(all_trips$end_station_name)
```

### STEP 4: Data Cleaning and adding column for analysis

Clean up the dataframe and add column to prepare for analysis.

```{r, results='hide'}
# Add more level of detail of date time to the rides. The dataset contain datetime only. You might want to know the breakdown of ride by months, weekday or hours.
all_trips$date <- as.Date(all_trips$started_at) 
all_trips$month <- format(as.Date(all_trips$date), "%b")
all_trips$day <- format(as.Date(all_trips$date), "%d")
all_trips$year <- format(as.Date(all_trips$date), "%Y")
all_trips$day_of_week <- format(as.Date(all_trips$date), "%A")
```

Add a column for the trip duration of each ride as ride_length in hrs

```{r, results='hide'}
# Trip duration
all_trips$ride_length = round(difftime(all_trips$ended_at, all_trips$started_at)/3600, 2)
# Inspect the all_trips table
summary(all_trips)
glimpse(all_trips)

# Change the ride_length to numeric
all_trips$ride_length <- as.numeric(all_trips$ride_length)
```

Remove ride_length that is negative and entries when bikes were taken out of docks and checked for quality by Divvy or ride_length was negative.

```{r, results='hide'}
all_trips_v2 <- all_trips[!(all_trips$start_station_name == "HQ QR" |
                                   all_trips$ride_length <= 0),]
```

Remove NA rows

```{r}
# Investigating the data frame, NA rows is found
summary(all_trips_v2)
```

```{r}
# Investigate the na rows
all_trips_v2[(is.na(all_trips_v2$started_at)),]
```

```{r}
# remove na rows
all_trips_v2 <- drop_na(all_trips_v2)
summary(all_trips_v2)
```

```{r}
glimpse(all_trips_v2)
```

Add a column indicating the range of ride_length each ride is in.

```{r}
# ride_length and frequency
all_trips_v3 = all_trips_v2 %>%
  mutate(duration_interval = case_when(
    ride_length <= 1 ~ "1) 0hrs ~ 1hrs",
    ride_length > 1 & ride_length <= 2.5 ~ "2) 1hrs ~ 2.5hrs",
    ride_length > 2.5 & ride_length <= 5 ~ "3) 2.5hrs ~ 5hrs",
    ride_length > 5 & ride_length <= 10 ~ "4) 5hrs ~ 10hrs",
    ride_length > 10 & ride_length <= 100 ~ "5) 10hrs ~ 100hrs",
    ride_length > 100 & ride_length <= 1000 ~ "6) 100hrs ~ 1,000hrs",
    ride_length > 1000 ~ "7) > 10,00hrs"))
```

Add a column to indicate if the start and end station is the same.

```{r}
# Add a column to see if start station == end station
all_trips_v3 <- all_trips_v3 %>% 
  mutate(start_equal_end_station = case_when(
    start_station_name == end_station_name ~ "Yes",
    start_station_name != end_station_name ~ "No"
  ))
```

### STEP 5: Conduct Analysis

#### Descriptive Analysis

Perform descriptive analysis to see what is the overall pictire of the data looks like.

```{r}
# Perform descriptive analysis
mean(all_trips_v3$ride_length)
```

```{r}
median(all_trips_v3$ride_length)
```

```{r}
max(all_trips_v3$ride_length)
```

```{r}
min(all_trips_v3$ride_length)
```

```{r}
# Perform descriptive analysis for casual vs memeber
aggregate(all_trips_v3$ride_length ~ all_trips_v3$user_type, FUN = mean)
```

```{r}
aggregate(all_trips_v3$ride_length ~ all_trips_v3$user_type, FUN = median)
```

```{r}
aggregate(all_trips_v3$ride_length ~ all_trips_v3$user_type, FUN = max)
```

```{r}
aggregate(all_trips_v3$ride_length ~ all_trips_v3$user_type, FUN = min)
```

```{r}
aggregate(all_trips_v3$ride_id ~ all_trips_v3$user_type, FUN = length)
```

Rearrange the weekday in order.

```{r, results='hide'}
# rearrange weekday
all_trips_v3$day_of_week <- ordered(all_trips_v3$day_of_week, levels=c("Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"))
```

#### High level comparison of casual and memeber user

Breakdown numbers of ride and average duration by months for casual vs member

```{r}
casual_member <- all_trips_v3 %>% 
  group_by(user_type) %>% 
  summarise(number_of_rides = n(),
            average_duration = mean(ride_length),
            total_duration = sum(ride_length))

casual_member <- casual_member %>% 
  mutate(percent_total_ride = round(prop.table(number_of_rides)*100),
         percent_total_duration = round(prop.table(total_duration)*100))%>% 
  select(user_type, number_of_rides, percent_total_ride, total_duration, percent_total_duration, average_duration)
```

> The total duration of all rides by the casual user is higher than member. The total number of rides by the casual user is lower than member. Thus, casual user tarvel with bike less frequent but much longer than member user.

##### Visualise the result

```{r}
slices <- casual_member$percent_total_duration 
lbls <- casual_member$user_type
lbls <- paste(lbls, slices, sep=" ") 
lbls <- paste(lbls,"%",sep="") # ad % to labels
pie(slices,labels = lbls, col=rainbow(length(lbls)),
    main="Total Ride Duration")
```

```{r}
slices <- casual_member$percent_total_ride 
lbls <- casual_member$user_type
lbls <- paste(lbls, slices, sep=" ") 
lbls <- paste(lbls,"%",sep="") # ad % to labels
pie(slices,labels = lbls, col=rainbow(length(lbls)),
    main="Total Number of Rides")
```


Type of bike use
   + docked bike may be the more prefer type or may be there are more docked bike
```{r}
all_trips_v3 %>% group_by(user_type, rideable_type) %>% 
  summarise(total_ride_number = n(),
            total_ride_duration = sum(ride_length)) %>% 
  mutate(percent_total_ride_number = prop.table(total_ride_number)*100,
         percent_total_ride_duration = prop.table(total_ride_duration)*100)
```

*** 

#### Breakdown the rides information by year, month, day_of_week and hours

Breakdown the trip info by weekday and hour

```{r}
# Breakdown numbers of ride and average duration by weekday for casual vs member
by_weekday_hour <- all_trips_v3 %>% 
  mutate(hour = as.factor(hour(started_at))) %>% 
  group_by(day_of_week, user_type, hour) %>%  #groups by usertype and weekday
  summarise(number_of_rides = n(),              #calculates the number of rides and average duration 
            average_duration = mean(ride_length),
            total_duration = sum(ride_length)) 
# sum(by_weekday_hour$number_of_rides) # data validation

by_weekday_hour
```

##### Visualise the result

```{r}
# weekday vs number of ride
by_weekday_hour %>% 
  ggplot(aes(x = day_of_week, 
             y = number_of_rides, 
             fill = user_type)) + 
  geom_col() + 
  labs(title = "Number of ride on each weekday",
       caption = "Data from  Jul 2020 to May 2021") +
  facet_wrap(~ user_type) +
  theme(axis.text.x = element_text(angle = 45))
```


```{r}
# weekday vs ride_length
by_weekday_hour %>% 
  ggplot(aes(x = day_of_week, 
             y = total_duration, 
             fill = user_type)) + 
  geom_col() +
  labs(title = "Total trip duration on each weekday",
       caption = "Data from  Jul 2020 to May 2021") +
  facet_wrap(~ user_type) +
  theme(axis.text.x = element_text(angle = 45))
```

> From the first two visuals, it is clear that the casual user uses the bike at a slightly higher rate on Friday and a significantly higer number of ride on the weekend.
>
> * The total duration of bike usage by casual user is also much higher in the weekend.
> * The bike usage of member very consistent through out the week.
   
```{r}
# weekday&hour vs ride
by_weekday_hour %>% 
  ggplot(aes(x = hour, 
             y = number_of_rides, 
             fill = user_type)) + 
  geom_col() +
  labs(title = "Breakdwon number of ride by day of Week and time",
       caption = "Data from  Jul 2020 to May 2021") +
  facet_grid(day_of_week~ user_type) +
  theme(axis.text.x = element_text(angle = 90))
```

> From the visual,
> 
> * member user shows two peak on the bike usage on weekday, one around 7am and one around 5pm. So member are more likely to be office worker.
> * casual user shows one peak on the bike usage on weekday at 5pm. So casual user on weekday could be office worker who choose to return home with bike and taking plublic transport in the morning.
   
Percentage breakdown of weekday travel for casual and member.

```{r}
all_trips_v3 %>% 
  group_by(user_type, day_of_week) %>% 
  summarise(total_duration = sum(ride_length),
            total_ride_number = n()) %>% 
  mutate(percent_total_duration = prop.table(total_duration)*100,
         percent_total_ride_number = prop.table(total_ride_number)*100)
```

> Almost half of total duration traveled by the casual were on weekend. Taking this into account, the company could launch a weekend only annual member, weekend or three days pass(including Friday).

Breakdown the trip info by month and day

```{r}
# Investigate any pattern in the time of the year
by_month_day <- all_trips_v3 %>%
  mutate(month_year = paste(month, year))

# reorder the months_year for correct timeline
by_month_day$month_year <- ordered(by_month_day$month_year, levels=c("Jun 2020", "Jul 2020", "Aug 2020", "Sep 2020", "Oct 2020", "Nov 2020", "Dec 2020", "Jan 2021", "Feb 2021", "Mar 2021", "Apr 2021", "May 2021"))

# Breakdown the trip info by month and day
by_month_day <- by_month_day %>%
  group_by(user_type, month_year, day) %>% 
  summarise(number_of_rides = n(),                      
            average_duration = mean(ride_length),
            total_duration = sum(ride_length)) %>%  
  arrange(user_type, month_year)
# sum(by_month_day$number_of_rides) # data validation
```

##### Visualise the result

```{r}
by_month_day %>% 
  ggplot(aes(x = month_year, 
             y = number_of_rides, 
             fill = user_type)) + 
  geom_col() +
  labs(title = "Average trip duration on each weekday",
       caption = "Data from  Jul 2020 to May 2021") +
  theme(axis.text.x = element_text(angle = 45))
```

```{r}
by_month_day %>% 
  ggplot(aes(x = month_year, 
             y = total_duration, 
             fill = user_type)) + 
  geom_col() +
  labs(title = "Average trip duration on each weekday",
       caption = "Data from  Jul 2020 to May 2021") +
  theme(axis.text.x = element_text(angle = 45))
```

> From the two visuals it can be concluded that
>
> * The usage of bike is correlated to the weather of the season. The bike usage is at its lowest due the cold weather which give rider many inconvenient to ride a bike.
> * The number of ride sharply increases at March as the spring start and warmer day are coming.
> * The number of ride peaked at the start of summer when the temperature and just right for outdoor activity.It then slowly decrease after July.

***


#### Breakdown the trip info by the range of travel time

Investigate the frequency of ride at each time interval.

```{r}
# Breakdown of number of ride by duration interval and user type
by_duration_interval <- all_trips_v3 %>%
  group_by(user_type, duration_interval) %>% 
  summarise(number_of_ride = n(),
            total_duration = sum(ride_length)) %>% 
  arrange(user_type) 

# Calculate the percentage breakdown for casual and member user to compare the different easily.
by_duration_interval <- by_duration_interval %>% 
  mutate(percent_number_of_ride = round(number_of_ride*100/sum(number_of_ride),6),
         percent_total_duration = round(total_duration*100/sum(total_duration),2)) %>% 
  select(user_type, duration_interval, number_of_ride, percent_number_of_ride, total_duration, percent_total_duration)
print(by_duration_interval)
```

##### Visualise the result

```{r}
by_duration_interval %>% 
  ggplot(aes(x = user_type, 
             y = percent_number_of_ride, 
             fill = duration_interval)) + 
  geom_col() +
  labs(title = "Percentage breakdwon of number of ride by the ride duration interval",
       caption = "Data from  Jul 2020 to May 2021") 
```

> * 99% of member user’s travel duration is less than or equal 1hr.
* 85% of casual user’s travel duration is less than or equal 1hr.

Investigating the popular trips

```{r}
# Investigating the popular trips  
start_end <- all_trips_v3 %>% 
  group_by(user_type, start_station_name, end_station_name, start_equal_end_station) %>% 
  summarise(number_of_ride = n(),
            average_duration = mean(ride_length),
            total_duration = sum(ride_length)
  ) %>% 
  arrange(desc(number_of_ride), user_type)
head(start_end,20)
```

> Popular trip (trip with the highest numberof ride) seem to start and end at the same station for causal user.

Investigate further to test the hypothesis that the majority of the start and end station is the same for casual user.

```{r}
# summaries the numbers in percentage for better comparison 
summarise_start_end <- all_trips_v3 %>% 
  group_by(user_type, start_equal_end_station) %>% 
  summarise(total_duration = sum(ride_length),
            number_of_ride = n()) %>% 
  mutate(percent_total_duration = round(prop.table(total_duration)*100,2),
         percent_number_of_ride = round(prop.table(number_of_ride)*100,2)) %>% 
  select(user_type, start_equal_end_station, total_duration, percent_total_duration, number_of_ride, percent_number_of_ride)
summarise_start_end
```

> Base on the results, the hypothesis is false. Although from the results, casual user is more likely to start and end at the same station. The popular trip location for casual just happen to have the highest number of ride.
>
> * 24.55% of total trip time spent and 16.7% of total number of trips travelled by casual start and end at the same station.
> * Only ~7.14% of trip time spent and 4.76% of total number of trips travelled by member start and end at the same station. Member user use bike for daily commute so this small figure make sense.
>
> Further analysis could be done to investigate the remaining 83.30% of ride travelled by casual, by calculating the distance between start and end stations. If the majority of the distance by casual user between station is short, this imply that the activity of causal user are concentrate in certain area, which is very useful to design marketing strategy accordingly with a foucus on the popular stations or trips.

***

#### Investigate the footprint for casual and member user

> Build one data frame to compare the number of time each station is use, both start and end.
>
> 1. create a dataframe for popular start station of causal only, arrange by the number of time the trip started.
> 2. create a dataframe for popular start station of member only, arrange by the number of time the trip started.
> 3. join two dataframe into one using start station name.
> 4. repeat these step for end station.
> 5. join start and end stations dataframe into one using staion name.

```{r}
# Popular_start_station for casual user
s_x <- all_trips_v3 %>% 
  group_by(start_station_name) %>% 
  filter(user_type == "casual") %>% 
  summarise(start_station_count_casual = n() ) %>%
  arrange(-start_station_count_casual) # desc

# Popular_start_station for member user
s_y <- all_trips_v3 %>% 
  group_by(start_station_name) %>% 
  filter(user_type == "member") %>% 
  summarise(start_station_count_member = n() ) %>%
  arrange(-start_station_count_member) # desc

# full join to obtain usage of all start_station
start_station <- full_join(s_x,s_y, by="start_station_name")
start_station <- rename(start_station, station_name = start_station_name)# rename for joining table 

# Popular_end_station for casual user
e_x <- all_trips_v3 %>% 
  group_by(end_station_name) %>% 
  filter(user_type == "casual") %>% 
  summarise(end_station_count_casual = n() ) %>% 
  arrange(-end_station_count_casual) # desc]

# Popular_end_station for member user
e_y <- all_trips_v3 %>% 
  group_by(end_station_name) %>% 
  filter(user_type == "member") %>% 
  summarise(end_station_count_member = n() ) %>% 
  arrange(-end_station_count_member) # desc

# full join to obtain usage of all end_station
end_station <- full_join(e_x,e_y, by="end_station_name")
end_station <- rename(end_station, station_name = end_station_name) # rename for joining table 

# full join to obtain usage of all station
start_end_station_count <- full_join(start_station, end_station, by="station_name")
start_end_station_count <- select(start_end_station_count, station_name, #Rearrange the column order
                                  start_station_count_casual, end_station_count_casual, 
                                  start_station_count_member, end_station_count_member)

# Investigating the new data frame and validation the data
summary(start_end_station_count)
```

```{r}
# # check: show equal to 3725514
# sum(start_end_station_count$start_station_count_casual, na.rm= TRUE) + sum(start_end_station_count$start_station_count_member, na.rm= TRUE) # data validation # na.rm
```

> * The top 20 popular stations of casual user and member is different.
* The top popular start and end station of casual user is highly similar. Most of the location are tourist attraction, so the casual user are likely to be couple, tourist or friends hanging out together.
8 The top popular start and end station of member user is highly similar.

Investigate what percentage of the ride is started at the top 20 popular stations.

```{r}
# % ride in top20
casual_top_20 <- head(start_end_station_count,20)
round(sum(casual_top_20$start_station_count_casual)/sum(start_end_station_count$start_station_count_casual,na.rm= TRUE)*100,2)
```

```{r}
round(sum(casual_top_20$start_station_count_member)/sum(start_end_station_count$start_station_count_member,na.rm= TRUE)*100,2)
```

> 20% of ride start from the top 20 popular station. Marketing plan should focus on casual user in these area.

***

#### How similar or different are the popular stations for causal user

```{r}
#Investigate how different are the popular start and end stations for casual and member user

# extract the ranked station list
casual_start_rank <- arrange(start_end_station_count,-start_station_count_casual)
member_start_rank <- arrange(start_end_station_count,-start_station_count_member)
casual_end_rank <- arrange(start_end_station_count,-end_station_count_casual)
member_end_rank <- arrange(start_end_station_count,-end_station_count_member)
```

Comparing the start and end station usage of casual user

* Investigate if the elements of top 20 start station is in the top 20 end station.

```{r}
# casual user: Top 20 popular start and end stations(rank by number of trip count)
x = 20 # number of popular stations

# create data frame with top x number of start station name 
start_station <- casual_start_rank[,1] #station name
top_start_station <- start_station[1:x,] # top x number of station 
top_start_station <- gsub(" ", "_", top_start_station$station_name)

# create data frame with top x number of end station name 
end_station <- casual_end_rank[,1]
top_end_station <- end_station[1:x,]
top_end_station <- gsub(" ", "_", top_end_station$station_name)

# create a vector to see the difference between popular start and end stations
similar <- c() # empty vector
for (i in 1:x) {
  if(top_start_station[i] %in% top_end_station){ # if element [i] of start_station_name is in end stations list
    similar <- c(similar, "TRUE") # add "TRUE" to the vector
  }else(similar <- c(similar, "FALSE")) # else add "FALSE" to the vector
} 
print(similar)
```

```{r}
# see how similar
similar <- data_frame(similar = similar)
```

```{r}
similar %>% group_by(similar) %>% summarise(count = n())
```

> From the results it can be conclude that the popular locations casual user like to visit is within a certain area.

Do member and casual user likely to travel in the same area?

```{r}
# casual
start_station <- casual_start_rank[,1]
top_start_station <- start_station[1:x,] 
top_start_station <- gsub(" ", "_", top_start_station$station_name)
print(top_start_station)
```

```{r}
# member
end_station <- member_start_rank[,1]
top_end_station <- end_station[1:x,]
top_end_station <- gsub(" ", "_", top_end_station$station_name)
print(top_end_station)
```

```{r}
similar <- c()

for (i in 1:x) {
  if(top_start_station[i] %in% top_end_station){
    similar <- c(similar, "TRUE")
  }else(similar <- c(similar, "FALSE"))
}
print(similar)
```

```{r}
similar <- data_frame(similar = similar)
similar %>% group_by(similar) %>% summarise(count = n())
```

> The popular area of member and casual user like to visit overlap partly.

***

### Conclusion

1. Member travel duration is shorter but travel more frequently than casual user.
2. To design marketing strategy for casual user, you should be targeting weekend and popular location casual users are likely to visit.
3. Both casual and member user prefer to ride the bike when the weather is warm.
4. Assuming their are enough choice for customers, the data suggest that docked bike are prefer.

***

### Recommendations

1. By providing 3-day/weekend and seasonal membership to increase the number of member
2. Marketing should be targeting casual user work commute back from work using bike and casual user who shows up at the popular location during weekend.
3. Provide package that tourist and traveler could benefit from.

